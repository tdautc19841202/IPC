+-------------------------------+
 IPCAM 项目量产测试工具软件需求  
+-------------------------------+

产测流程
--------

按生产顺序，产测包含如下阶段：

1. SMT 测试
2. 验焦测试
3. 写号+吞吐量测试
4. 整机功能测试


SMT 测试
--------
SMT 测试在板子贴片完成后进行，主要目的是尽可能完整的发现硬件问题以方便维修。

主要的测试项目有：

1. 摄像头
2. 喇叭
3. 咪头
4. led 指示灯
5. 红外指示灯
6. 按键
7. 光感
8. wifi
9. 固件版本

每个测试项目要尽可能的独立测试（比如说不能因为 wifi 不通，导致按键、喇叭等项目无法测试）

建议的测试方法：
1. 摄像头建议 uvc 出图               -> 可判定 usb 和 摄像头是否 ok
2. 开机直接亮 led 灯                 -> 可判定 led 是否 ok
3. 按键按下后 led 闪灯，放开恢复常亮 -> 可判定按键是否 ok
4. 开机直接播放测试音频              -> 可判定 spk 是否 ok
5. 光感要能自动切换夜视              -> 可判定 ircut 是否 ok 和红外灯是否 ok，如果 ircut + irled 都不切那么光感 ng 的可能性更大
6. wifi 自动连接路由器并报告固件版本 -> 可判定 wifi 否是 ok，和固件版本是否 ok
7. mic 的测试可以通过 uvc 出图或 rtsp 出图，pc 上用耳机收听来判定
   或者做成按键按下后不放开，录 1s 音再播放

对网络通信协议的需求是，pc 工具能够发现设备，并获取到固件版本号


验焦测试
--------
验焦测试主要测试镜头调焦是否 ok，以及是否存在暗角、条纹等问题，主要是测试员主观判定。
对测试软件的需求就是要能出图即可，建议用 uvc 出图，用 wifi + rtsp 出图的风险在于，验焦测试工位一直都在工作，也就是说 wifi + rtsp
对网络带宽的占用是一直存在的。这样会影响到后面整机功能测试工位的网络通信的稳定性。

如果是 uvc 出图，对网络通信协议无需求
如果是 wifi + rtsp 出图，需要 pc 工具能够发现设备，并获得 ip 地址，并支持 rtsp


写号+吞吐量测试
---------------
这个工位需要完成 wifi 吞吐量测试、SN + MAC 写号、固件版本号检查等工作。另外也可以根据需要增加 spk+mic 的自动化测试。
这个阶段的测试，设备将被放入信号屏蔽箱，因此不存在 wifi 信号干扰问题。

对网络通信协议的需求是：
1. 发现设备获取 ip
2. 支持写号命令
3. 获取 SN + MAC + 固件版本号命令
4. iperf 吞吐量测试支持
5. spk+mic 自动化测试命令及结果获取
（测试结果最好一条命令就查询出来）


整机功能测试
------------
这是产品测试的最后一步，测试目的希望完成对 IPCAM 整机的硬件和功能的完整测试。
由于前面阶段的测试基本可以保证 wifi 硬件是 ok 的，为提高测试效率我们希望更多的测试项目能自动完成，并通过网络信息协议把结果报告给 pc 工具。

自动测试项目包括：
1. wifi         -> 网络通信协议可自动判定
2. 按键         -> 测试员按下放开按键后设备端程序可判定 pass
3. 光感         -> 测试员遮挡放开光敏后设备端程序可判定 pass
4. 电池         -> 设备端程序可直接根据电池电压值进行判定
5. SN 检查      -> SN + MAC + VER 通过网络协议报给 pc 工具由 pc 工具检查判定
6. MAC 检查
7. 版本号检查
（测试结果最好一条命令就查询出来）

必须要测试员主观判定的项目有：
1. led
2. 红外灯+ircut -> 遮挡光敏要能自动切换，方便测试员快速判定
3. 喇叭（要判定音质）
4. 咪头（要判定音质）
5. 摄像头（要判定画质）

为提升测试效率，建议做到：
1. 开机播放测试音频
2. 开机亮 led 灯
3. 开机 uvc 出图
4. 按键按下后 led 闪灯，放开恢复常亮
5. 光感要能自动切换夜视
6. 出图后设备 mic 采集声音要能传到 pc 工具


对网络通信协议的建议
--------------------
收发数据包尽量小，通信频率尽可能少，以节省带宽，提升稳定性。


总结
----
以上是 IPCAM 项目的产测工具软件需求，这个需求是与工厂充分讨论，并在产线上实际测试运行后，总结出来的。
同时考虑了生产测试的效率、稳定性、以及程序实现的可能性和便利性，等等因素。可作为 IPCAM 产品产测工具的设计参考。



爱培科 M2M
 2019-3-7 















